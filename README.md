# Study with Convolutional and Transformer Models on Ornamental Rock Databases

This code was used in my master's degree.

## About the code

The code is based on a Python notebook. There are several Python scripts to preprocess the images (preprocess_images.py), generate balanced databases (generatebalanceddatabase.py), and analyze the total number of images in the directories (analysetotalimages.py).

The file "CÃ³digo_artigo_2024.ipynb" contains the code used. It includes a main class, training_class_models(), which loads the models and images, trains the models, and then calls the test_model() method to evaluate the trained models on the test database.

The code will generate two directories:
 - models
 - runs

The "models" directory save each model trained with the .pth file, a json file with the classes trained, another json file with the results and the confusion matrix image generated by the test process.
The "runs" directory stores the tensor board files that can be accessed by the tensor board. To start the tensor board and visualize the reports, execute:
    tensorboard --logdir "runs"
Inside the root directory of the code.

## About the database

This project envolved the creation of a database of Ornamental Rocks, with support of Angramar, a company based in Cachoeiro de Itapemirim-E.S. The database consists in 1798 images, divided into 12 classes of ornamental rocks. There are tree directories in the database:
  - train
  - test
  - val

with each of them containing the same classes directories. To run the program correctly, it's necessary an "image" directory in the root directory of the code, with the tree directories.

The database created by the author for this project can be accessed in https://www.kaggle.com/databases/douglasfiriodias/ornamental-rocks-database.
